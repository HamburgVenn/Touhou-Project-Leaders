reimu_spell_card_1_effect = {
    from = {
        add_resource = {
            thl_bomb = -1
        }
    }
    if = {
        limit = {
            root = {
                is_scope_type = fleet #保险措施
            }
        }
        root = {
            random_list = {
                1 = {
                    create_ambient_object = {
                        type = red_sun_grow_particle_object
                        location = this
                        duration = 1
                    }
                }
                1 = {
                    create_ambient_object = {
                        type = yellow_sun_grow_particle_object
                        location = this
                        duration = 1
                    }
                }
                1 = {
                    create_ambient_object = {
                        type = blue_sun_grow_particle_object
                        location = this
                        duration = 1
                    }
                }
            }
            while = {
                count = 6
                random_owned_ship = {
                    reroll_random = yes
                    set_variable_to_random_value = {
                        which = reimu_spell_damage
                        min = 200
                        max = 1000
                    }
                    reduce_hp = reimu_spell_damage
                }
            }
            add_modifier = {
                modifier = huuin_modifier
                days = 30
            }
        }
    }
}

reimu_spell_card_1_ex_effect = {
    from = {
        add_resource = {
            thl_bomb = -2
        }
    }
    if = {
        limit = {
            root = {
                is_scope_type = fleet #保险措施
            }
        }
        root = {
            random_list = {
                1 = {
                    create_ambient_object = {
                        type = red_sun_grow_particle_object
                        location = this
                        duration = 1
                    }
                }
                1 = {
                    create_ambient_object = {
                        type = yellow_sun_grow_particle_object
                        location = this
                        duration = 1
                    }
                }
                1 = {
                    create_ambient_object = {
                        type = blue_sun_grow_particle_object
                        location = this
                        duration = 1
                    }
                }
            }
            while = {
                count = 8
                random_owned_ship = {
                    reroll_random = yes
                    set_variable_to_random_value = {
                        which = reimu_spell_damage
                        min = 2000
                        max = 4000
                    }
                    reduce_hp = reimu_spell_damage
                }
            }
            add_modifier = {
                modifier = huuin_modifier
                days = 30
            }
        }
    }
}

reimu_spell_card_2_effect = {
    from = {
        add_resource = {
            thl_bomb = -2
        }
    }
    if = {
        limit = {
            root = {
                is_scope_type = fleet #保险措施
            }
        }
        root = {
            create_ambient_object = {
                type = red_sun_grow_particle_object
                location = this
                duration = 1
            }
            add_modifier = {
                modifier = huuin_modifier
                days = 120
            }
        }
    }
}

reimu_spell_card_3_effect = {
    from = {
        add_resource = {
            thl_bomb = -1
        }
    }
    if = {
        limit = {
            root = {
                is_scope_type = planet
            }
        }
        root = {
            add_modifier = {
                modifier = modifier_planet_barrier
            }
        }
    }
}

reimu_spell_card_4_effect = {
    from = {
        add_resource = {
            thl_bomb = -4
        }
    }
    from = {
        random_owned_fleet = {
            limit = {
                exists = leader
                leader = {
                    has_trait = leader_trait_fly
                }
            }
            set_event_locked = yes
            fleet_event = {
                id = touhou_paragon_spell.1
                days = 30
            }
        }
    }
}

reimu_spell_card_5_effect = {
    from = {
        add_resource = {
            thl_bomb = -1
        }
    }
    if = {
        limit = {
            root = {
                is_scope_type = planet
            }
        }
        root = {
            solar_system = {
                spawn_megastructure = {
                    type = reimu_gateway
                    planet = root
                    owner = from
                    orbit_distance = 5
                    random_pos = yes
                    init_effect = {
                        solar_system = {
                            set_star_flag = reimu_gateway_planet
                            system_event = {
                                id = touhou_paragon_spell.4
                                days = 360
                            }
                        }
                    }
                }
            }
        }
    }
}

reimu_spell_card_6_effect = {
    from = {
        add_resource = {
            thl_bomb = -5
        }
    }
    from = {
        random_owned_fleet = {
            limit = {
                exists = leader
                leader = {
                    has_trait = leader_trait_fly
                }
            }
            add_modifier = {
                modifier = invincible_fleet
                days = 60
            }
            fleet_event = {
                id = touhou_paragon_spell.5
                days = 60
            }
            set_fleet_settings = {
                is_boss = yes
            }
        }
    }
}

koishi_spell_card_1_effect = {
    from = {
        add_resource = {
            thl_bomb = -1
        }
    }
    if = {
        limit = {
            root = {
                is_scope_type = planet
            }
        }
        root = {
            add_modifier = {
                modifier = modifier_ancestor_dream
            }
        }
    }
}

koishi_spell_card_2_effect = {
    from = {
        add_resource = {
            thl_bomb = -2
        }
    }
    if = {
        limit = {
            NOT = {
                exists = event_target:koishi_country
            }
        }
        create_country = {
            name = NAME_Koishi_Fleet
            adjective = NAME_Koishi_Fleet
            type = koishi_berserk_fleet
            flag = {
                icon={
                    category="spherical"
                    file="flag_spherical_12.dds"
                }
                background={
                    category="backgrounds"
                    file="flag_BG_31.dds"
                }
                colors={
                    "desert_yellow"
                    "swamp_green"
                    "null"
                    "null"
                }
            }
            auto_delete = no
            randomize_ethos = yes
            released_from_country = from
            ignore_initial_colony_error = yes
        }
        last_created_country = {
            save_global_event_target_as = koishi_country
            copy_techs_from = { target = from }
        }
    }
    else = {
        event_target:koishi_country = {
            copy_techs_from = { target = from }
        }
    }
    from = {
        every_owned_fleet = {
            limit = {
                exists = leader
                leader = { has_trait = leader_trait_subconscious }
            }
            add_modifier = {
                modifier = rampage_fleet
                days = -1
            }
            set_owner = event_target:koishi_country
            set_fleet_settings = {
                can_change_leader = no
                is_boss = yes
            }
        }
        set_country_flag = koishi_rampage
    }
}

koishi_spell_card_3_effect = {
    from = {
        remove_country_flag = koishi_rampage
        add_resource = {
            thl_bomb = -3
        }
    }
    event_target:koishi_country = {
        every_owned_fleet = {
            remove_modifier = rampage_fleet
            set_fleet_settings = {
                can_change_leader = yes
                is_boss = no
            }
            set_owner = from
            leader = {
                set_owner = from
            }
            solar_system = {
                every_fleet_in_system = {
                    add_modifier = {
                        modifier = super_ego
                        days = 30
                    }
                }
            }
            solar_system = {
                every_fleet_in_system = {
                    add_modifier = {
                        modifier = super_ego
                        days = 30
                    }
                }
            }
        }
    }
}

koishi_spell_card_4_effect = {
    add_resource = {
        thl_bomb = -4
    }
    from = {
        every_owned_fleet = {
            limit = {
                exists = leader
                leader = { has_trait = leader_trait_subconscious }
            }
            add_modifier = {
                modifier = koishi_surprise
                days = 30
            }
            set_location = root
        }
    }
}